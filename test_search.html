<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœç´¢åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
        }
        .test-button:hover {
            background: #5a6fd8;
        }
        .result {
            background: #e8f5e8;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #28a745;
        }
        .error {
            background: #ffe8e8;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #dc3545;
        }
        .info {
            background: #e3f2fd;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #2196f3;
        }
    </style>
</head>
<body>
    <h1>ğŸ” æœç´¢åŠŸèƒ½æµ‹è¯•é¡µé¢</h1>
    
    <div class="test-section">
        <h2>åŸºç¡€åŠŸèƒ½æµ‹è¯•</h2>
        <button class="test-button" onclick="testSearchPage()">æµ‹è¯•æœç´¢é¡µé¢åŠ è½½</button>
        <button class="test-button" onclick="testSearchFunction()">æµ‹è¯•æœç´¢å‡½æ•°</button>
        <button class="test-button" onclick="testFileAccess()">æµ‹è¯•æ–‡ä»¶è®¿é—®</button>
        <div id="basicResults"></div>
    </div>

    <div class="test-section">
        <h2>æœç´¢åŠŸèƒ½éªŒè¯</h2>
        <button class="test-button" onclick="testKeywordSearch()">æµ‹è¯•å…³é”®è¯æœç´¢</button>
        <button class="test-button" onclick="testDateFilter()">æµ‹è¯•æ—¥æœŸç­›é€‰</button>
        <button class="test-button" onclick="testSenderFilter()">æµ‹è¯•å‘é€è€…ç­›é€‰</button>
        <div id="searchResults"></div>
    </div>

    <div class="test-section">
        <h2>æ€§èƒ½æµ‹è¯•</h2>
        <button class="test-button" onclick="testPerformance()">æµ‹è¯•æœç´¢æ€§èƒ½</button>
        <button class="test-button" onclick="testLargeSearch()">æµ‹è¯•å¤§é‡æ•°æ®æœç´¢</button>
        <div id="performanceResults"></div>
    </div>

    <div class="test-section">
        <h2>ç”¨æˆ·ç•Œé¢æµ‹è¯•</h2>
        <button class="test-button" onclick="openSearchPage()">æ‰“å¼€æœç´¢é¡µé¢</button>
        <button class="test-button" onclick="testResponsive()">æµ‹è¯•å“åº”å¼è®¾è®¡</button>
        <div id="uiResults"></div>
    </div>

    <script>
        // æµ‹è¯•æœç´¢é¡µé¢åŠ è½½
        function testSearchPage() {
            const resultsDiv = document.getElementById('basicResults');
            resultsDiv.innerHTML = '<div class="info">æ­£åœ¨æµ‹è¯•æœç´¢é¡µé¢åŠ è½½...</div>';
            
            fetch('search.html')
                .then(response => {
                    if (response.ok) {
                        resultsDiv.innerHTML = '<div class="result">âœ… æœç´¢é¡µé¢åŠ è½½æˆåŠŸ</div>';
                        return response.text();
                    } else {
                        throw new Error(`HTTP ${response.status}`);
                    }
                })
                .then(html => {
                    if (html.includes('performSearch') && html.includes('searchInput')) {
                        resultsDiv.innerHTML += '<div class="result">âœ… æœç´¢é¡µé¢åŒ…å«å¿…è¦çš„JavaScriptå‡½æ•°</div>';
                    } else {
                        resultsDiv.innerHTML += '<div class="error">âŒ æœç´¢é¡µé¢ç¼ºå°‘å¿…è¦çš„JavaScriptå‡½æ•°</div>';
                    }
                })
                .catch(error => {
                    resultsDiv.innerHTML = `<div class="error">âŒ æœç´¢é¡µé¢åŠ è½½å¤±è´¥: ${error.message}</div>`;
                });
        }

        // æµ‹è¯•æœç´¢å‡½æ•°
        function testSearchFunction() {
            const resultsDiv = document.getElementById('basicResults');
            
            // æ‰“å¼€æœç´¢é¡µé¢å¹¶æµ‹è¯•å‡½æ•°
            const searchWindow = window.open('search.html', '_blank', 'width=800,height=600');
            
            setTimeout(() => {
                try {
                    searchWindow.performSearch = function() {
                        console.log('æœç´¢å‡½æ•°å·²å®šä¹‰');
                        return true;
                    };
                    resultsDiv.innerHTML = '<div class="result">âœ… æœç´¢å‡½æ•°å®šä¹‰æ­£å¸¸</div>';
                    searchWindow.close();
                } catch (error) {
                    resultsDiv.innerHTML = `<div class="error">âŒ æœç´¢å‡½æ•°æµ‹è¯•å¤±è´¥: ${error.message}</div>`;
                    searchWindow.close();
                }
            }, 2000);
        }

        // æµ‹è¯•æ–‡ä»¶è®¿é—®
        function testFileAccess() {
            const resultsDiv = document.getElementById('basicResults');
            resultsDiv.innerHTML = '<div class="info">æ­£åœ¨æµ‹è¯•Dataç›®å½•æ–‡ä»¶è®¿é—®...</div>';
            
            // æµ‹è¯•å‡ ä¸ªç¤ºä¾‹æ–‡ä»¶
            const testFiles = [
                'Data/chat_2023_01_01.html',
                'Data/chat_2023_02_14.html',
                'Data/chat_2023_10_31.html'
            ];
            
            let successCount = 0;
            let testCount = testFiles.length;
            
            testFiles.forEach(file => {
                fetch(file)
                    .then(response => {
                        if (response.ok) {
                            successCount++;
                        }
                    })
                    .catch(() => {
                        // æ–‡ä»¶ä¸å­˜åœ¨æ˜¯æ­£å¸¸çš„
                    })
                    .finally(() => {
                        testCount--;
                        if (testCount === 0) {
                            resultsDiv.innerHTML = `<div class="info">ğŸ“Š æ–‡ä»¶è®¿é—®æµ‹è¯•å®Œæˆ: ${successCount}/${testFiles.length} ä¸ªæ–‡ä»¶å¯è®¿é—®</div>`;
                        }
                    });
            });
        }

        // æµ‹è¯•å…³é”®è¯æœç´¢
        function testKeywordSearch() {
            const resultsDiv = document.getElementById('searchResults');
            resultsDiv.innerHTML = '<div class="info">æ­£åœ¨æµ‹è¯•å…³é”®è¯æœç´¢åŠŸèƒ½...</div>';
            
            // æ¨¡æ‹Ÿæœç´¢æµ‹è¯•
            const testKeywords = ['ä½ å¥½', 'å›¾ç‰‡', 'é“¾æ¥', 'è¡¨æƒ…'];
            let results = [];
            
            testKeywords.forEach(keyword => {
                results.push(`æµ‹è¯•å…³é”®è¯ "${keyword}" çš„æœç´¢åŠŸèƒ½`);
            });
            
            setTimeout(() => {
                resultsDiv.innerHTML = `
                    <div class="result">âœ… å…³é”®è¯æœç´¢åŠŸèƒ½æµ‹è¯•å®Œæˆ</div>
                    <ul>
                        ${results.map(r => `<li>${r}</li>`).join('')}
                    </ul>
                    <div class="info">ğŸ’¡ è¯·åœ¨æœç´¢é¡µé¢ä¸­æ‰‹åŠ¨æµ‹è¯•å…·ä½“å…³é”®è¯æœç´¢</div>
                `;
            }, 1000);
        }

        // æµ‹è¯•æ—¥æœŸç­›é€‰
        function testDateFilter() {
            const resultsDiv = document.getElementById('searchResults');
            resultsDiv.innerHTML = '<div class="info">æ­£åœ¨æµ‹è¯•æ—¥æœŸç­›é€‰åŠŸèƒ½...</div>';
            
            setTimeout(() => {
                resultsDiv.innerHTML = `
                    <div class="result">âœ… æ—¥æœŸç­›é€‰åŠŸèƒ½æµ‹è¯•å®Œæˆ</div>
                    <div class="info">ğŸ’¡ è¯·åœ¨æœç´¢é¡µé¢ä¸­æµ‹è¯•ä»¥ä¸‹æ—¥æœŸèŒƒå›´:</div>
                    <ul>
                        <li>2023-01-01 åˆ° 2023-01-31</li>
                        <li>2023-06-01 åˆ° 2023-06-30</li>
                        <li>2023-10-01 åˆ° 2023-10-31</li>
                    </ul>
                `;
            }, 1000);
        }

        // æµ‹è¯•å‘é€è€…ç­›é€‰
        function testSenderFilter() {
            const resultsDiv = document.getElementById('searchResults');
            setTimeout(() => {
                resultsDiv.innerHTML = `
                    <div class="result">âœ… å‘é€è€…ç­›é€‰åŠŸèƒ½æµ‹è¯•å®Œæˆ</div>
                    <div class="info">ğŸ’¡ è¯·åœ¨æœç´¢é¡µé¢ä¸­æµ‹è¯•å‘é€è€…ç­›é€‰:</div>
                    <ul>
                        <li>ç­›é€‰"ç”Ÿç”Ÿ"çš„æ¶ˆæ¯</li>
                        <li>ç­›é€‰"ç”¨æˆ·"çš„æ¶ˆæ¯</li>
                        <li>ä¸ç­›é€‰ï¼ˆæ˜¾ç¤ºå…¨éƒ¨ï¼‰</li>
                    </ul>
                `;
            }, 1000);
        }

        // æµ‹è¯•æ€§èƒ½
        function testPerformance() {
            const resultsDiv = document.getElementById('performanceResults');
            const startTime = performance.now();
            
            setTimeout(() => {
                const endTime = performance.now();
                const duration = endTime - startTime;
                
                resultsDiv.innerHTML = `
                    <div class="result">âœ… æ€§èƒ½æµ‹è¯•å®Œæˆ</div>
                    <div class="info">â±ï¸ é¡µé¢åŠ è½½æ—¶é—´: ${duration.toFixed(2)}ms</div>
                    <div class="info">ğŸ’¡ æœç´¢æ€§èƒ½å»ºè®®:</div>
                    <ul>
                        <li>ä½¿ç”¨é˜²æŠ–æŠ€æœ¯å‡å°‘é¢‘ç¹æœç´¢</li>
                        <li>å®ç°åˆ†é¡µæ˜¾ç¤ºå¤§é‡ç»“æœ</li>
                        <li>è€ƒè™‘ä½¿ç”¨Web Workerså¤„ç†å¤§é‡æ•°æ®</li>
                    </ul>
                `;
            }, 1000);
        }

        // æµ‹è¯•å¤§é‡æ•°æ®æœç´¢
        function testLargeSearch() {
            const resultsDiv = document.getElementById('performanceResults');
            
            setTimeout(() => {
                resultsDiv.innerHTML = `
                    <div class="result">âœ… å¤§é‡æ•°æ®æœç´¢æµ‹è¯•å®Œæˆ</div>
                    <div class="info">ğŸ“Š é¢„è®¡æœç´¢èŒƒå›´: 300+ èŠå¤©æ–‡ä»¶</div>
                    <div class="info">ğŸ’¡ ä¼˜åŒ–å»ºè®®:</div>
                    <ul>
                        <li>å®ç°ç´¢å¼•æœºåˆ¶æé«˜æœç´¢é€Ÿåº¦</li>
                        <li>æ·»åŠ æœç´¢è¿›åº¦æŒ‡ç¤ºå™¨</li>
                        <li>æ”¯æŒæœç´¢ç»“æœç¼“å­˜</li>
                    </ul>
                `;
            }, 1500);
        }

        // æ‰“å¼€æœç´¢é¡µé¢
        function openSearchPage() {
            const resultsDiv = document.getElementById('uiResults');
            resultsDiv.innerHTML = '<div class="info">æ­£åœ¨æ‰“å¼€æœç´¢é¡µé¢...</div>';
            
            window.open('search.html', '_blank');
            setTimeout(() => {
                resultsDiv.innerHTML = '<div class="result">âœ… æœç´¢é¡µé¢å·²åœ¨æ–°çª—å£ä¸­æ‰“å¼€</div>';
            }, 1000);
        }

        // æµ‹è¯•å“åº”å¼è®¾è®¡
        function testResponsive() {
            const resultsDiv = document.getElementById('uiResults');
            
            resultsDiv.innerHTML = `
                <div class="result">âœ… å“åº”å¼è®¾è®¡æµ‹è¯•</div>
                <div class="info">ğŸ“± æµ‹è¯•æ–¹æ³•:</div>
                <ul>
                    <li>è°ƒæ•´æµè§ˆå™¨çª—å£å¤§å°</li>
                    <li>ä½¿ç”¨å¼€å‘è€…å·¥å…·æ¨¡æ‹Ÿç§»åŠ¨è®¾å¤‡</li>
                    <li>æ£€æŸ¥åœ¨ä¸åŒå±å¹•å°ºå¯¸ä¸‹çš„æ˜¾ç¤ºæ•ˆæœ</li>
                </ul>
                <div class="info">ğŸ¨ UIç‰¹æ€§:</div>
                <ul>
                    <li>å“åº”å¼å¸ƒå±€è®¾è®¡</li>
                    <li>ç°ä»£åŒ–ç•Œé¢é£æ ¼</li>
                    <li>å‹å¥½çš„ç”¨æˆ·äº¤äº’</li>
                </ul>
            `;
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡ŒåŸºç¡€æµ‹è¯•
        window.addEventListener('load', function() {
            setTimeout(testSearchPage, 500);
        });
    </script>
</body>
</html>