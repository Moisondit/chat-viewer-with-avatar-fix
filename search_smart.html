<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èŠå¤©è®°å½•æœç´¢ - æ™ºèƒ½ç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .search-section {
            padding: 30px;
            background: #f8f9fa;
        }

        .search-form {
            position: relative;
            margin-bottom: 20px;
        }

        .search-input-wrapper {
            position: relative;
            flex: 1;
        }

        .search-input {
            width: 100%;
            padding: 15px 50px 15px 20px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .search-button, .cancel-button {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            padding: 10px 20px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .search-button:hover {
            transform: translateY(-50%) scale(1.05);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.4);
        }

        .cancel-button {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            display: none;
        }

        .suggestions-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 0 0 10px 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

        .suggestion-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: background 0.2s ease;
            border-bottom: 1px solid #f8f9fa;
        }

        .suggestion-item:hover {
            background: #f8f9fa;
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }

        .suggestion-highlight {
            font-weight: bold;
            color: #4facfe;
        }

        .filters {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .filter-select {
            padding: 10px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            cursor: pointer;
        }

        .hot-keywords {
            margin-bottom: 20px;
        }

        .hot-keywords h3 {
            font-size: 16px;
            margin-bottom: 10px;
            color: #495057;
        }

        .keyword-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .keyword-tag {
            padding: 6px 12px;
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            border: 1px solid #e1bee7;
            border-radius: 20px;
            font-size: 12px;
            color: #6a1b9a;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .keyword-tag:hover {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(79, 172, 254, 0.3);
        }

        .progress-section {
            padding: 20px 30px;
            background: white;
            border-bottom: 1px solid #e9ecef;
            display: none;
        }

        .progress-bar-container {
            background: #e9ecef;
            border-radius: 10px;
            height: 8px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 10px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            color: #6c757d;
        }

        .progress-stats {
            display: flex;
            gap: 20px;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .stat-number {
            font-weight: bold;
            color: #4facfe;
        }

        .results-section {
            padding: 30px;
            max-height: 600px;
            overflow-y: auto;
        }

        .result-item {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-item:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .result-sender {
            font-weight: bold;
            color: #495057;
        }

        .result-time {
            font-size: 12px;
            color: #6c757d;
        }

        .result-content {
            color: #495057;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .result-file {
            font-size: 12px;
            color: #6c757d;
            background: #f8f9fa;
            padding: 5px 10px;
            border-radius: 5px;
            display: inline-block;
        }

        .highlight {
            background: #fff3cd;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: bold;
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #6c757d;
        }

        .no-results-icon {
            font-size: 48px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .search-stats {
            background: #f8f9fa;
            padding: 15px 30px;
            border-top: 1px solid #e9ecef;
            font-size: 14px;
            color: #6c757d;
            text-align: center;
        }

        .loading-spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #4facfe;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 8px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” èŠå¤©è®°å½•æœç´¢ - æ™ºèƒ½ç‰ˆ</h1>
            <p>å¿«é€Ÿæœç´¢æ‚¨çš„èŠå¤©è®°å½•ï¼Œæ”¯æŒæ™ºèƒ½å»ºè®®å’Œçƒ­é—¨å…³é”®è¯</p>
        </div>

        <div class="search-section">
            <div class="search-form">
                <div class="search-input-wrapper">
                    <input type="text" 
                           class="search-input" 
                           id="searchInput" 
                           placeholder="è¾“å…¥æœç´¢å…³é”®è¯..."
                           autocomplete="off">
                    <button class="search-button" id="searchButton">æœç´¢</button>
                    <button class="cancel-button" id="cancelButton">å–æ¶ˆ</button>
                    <div class="suggestions-dropdown" id="suggestionsDropdown"></div>
                </div>
            </div>

            <div class="hot-keywords">
                <h3>ğŸ”¥ çƒ­é—¨å…³é”®è¯</h3>
                <div class="keyword-tags" id="keywordTags">
                    <span class="keyword-tag" data-keyword="ä½ å¥½">ä½ å¥½</span>
                    <span class="keyword-tag" data-keyword="è°¢è°¢">è°¢è°¢</span>
                    <span class="keyword-tag" data-keyword="æ™šå®‰">æ™šå®‰</span>
                    <span class="keyword-tag" data-keyword="å“ˆå“ˆ">å“ˆå“ˆ</span>
                    <span class="keyword-tag" data-keyword="å¼€å¿ƒ">å¼€å¿ƒ</span>
                    <span class="keyword-tag" data-keyword="å¿™ç¢Œ">å¿™ç¢Œ</span>
                    <span class="keyword-tag" data-keyword="å‘¨æœ«">å‘¨æœ«</span>
                    <span class="keyword-tag" data-keyword="ç”Ÿæ—¥">ç”Ÿæ—¥</span>
                </div>
            </div>

            <div class="filters">
                <select class="filter-select" id="dateFilter">
                    <option value="">æ‰€æœ‰æ—¶é—´</option>
                    <option value="today">ä»Šå¤©</option>
                    <option value="week">æœ¬å‘¨</option>
                    <option value="month">æœ¬æœˆ</option>
                    <option value="year">ä»Šå¹´</option>
                </select>
                <select class="filter-select" id="senderFilter">
                    <option value="">æ‰€æœ‰å‘é€è€…</option>
                    <option value="æ˜Ÿå¦‚é›¨">æ˜Ÿå¦‚é›¨</option>
                    <option value="æˆ‘">æˆ‘</option>
                </select>
                <select class="filter-select" id="typeFilter">
                    <option value="">æ‰€æœ‰ç±»å‹</option>
                    <option value="text">æ–‡å­—æ¶ˆæ¯</option>
                    <option value="image">å›¾ç‰‡æ¶ˆæ¯</option>
                    <option value="emoji">è¡¨æƒ…æ¶ˆæ¯</option>
                </select>
            </div>
        </div>

        <div class="progress-section" id="progressSection">
            <div class="progress-bar-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div class="progress-info">
                <div class="progress-stats">
                    <div class="stat-item">
                        <span>å·²æœç´¢:</span>
                        <span class="stat-number" id="searchedCount">0</span>
                        <span>ä¸ªæ–‡ä»¶</span>
                    </div>
                    <div class="stat-item">
                        <span>æ‰¾åˆ°:</span>
                        <span class="stat-number" id="foundCount">0</span>
                        <span>æ¡ç»“æœ</span>
                    </div>
                </div>
                <div class="progress-text">
                    <span id="progressText">å‡†å¤‡æœç´¢...</span>
                </div>
            </div>
        </div>

        <div class="results-section" id="resultsSection">
            <div class="no-results">
                <div class="no-results-icon">ğŸ”</div>
                <h3>å¼€å§‹æœç´¢èŠå¤©è®°å½•</h3>
                <p>è¾“å…¥å…³é”®è¯æˆ–ç‚¹å‡»çƒ­é—¨æ ‡ç­¾å¼€å§‹æœç´¢</p>
            </div>
        </div>

        <div class="search-stats" id="searchStats" style="display: none;">
            <span id="statsText"></span>
        </div>
    </div>

    <script>
        class ChatSearchEngine {
            constructor() {
                this.files = [
                    'Data/chat_2023_01_15.html',
                    'Data/chat_2023_01_16.html',
                    'Data/chat_2023_01_17.html',
                    'Data/chat_2023_01_18.html',
                    'Data/chat_2023_01_19.html',
                    'Data/chat_2023_01_20.html',
                    'Data/chat_2023_01_21.html',
                    'Data/chat_2023_01_22.html',
                    'Data/chat_2023_01_23.html',
                    'Data/chat_2023_01_24.html',
                    'Data/chat_2023_01_25.html',
                    'Data/chat_2023_01_26.html',
                    'Data/chat_2023_01_27.html',
                    'Data/chat_2023_01_28.html',
                    'Data/chat_2023_01_29.html',
                    'Data/chat_2023_01_30.html',
                    'Data/chat_2023_01_31.html',
                    'Data/chat_2023_02_01.html',
                    'Data/chat_2023_02_02.html',
                    'Data/chat_2023_02_03.html',
                    'Data/chat_2023_02_04.html',
                    'Data/chat_2023_02_05.html',
                    'Data/chat_2023_02_06.html',
                    'Data/chat_2023_02_07.html',
                    'Data/chat_2023_02_08.html',
                    'Data/chat_2023_02_09.html',
                    'Data/chat_2023_02_10.html',
                    'Data/chat_2023_02_11.html',
                    'Data/chat_2023_02_12.html',
                    'Data/chat_2023_02_13.html',
                    'Data/chat_2023_02_14.html',
                    'Data/chat_2023_02_15.html',
                    'Data/chat_2023_02_16.html',
                    'Data/chat_2023_02_17.html',
                    'Data/chat_2023_02_18.html',
                    'Data/chat_2023_02_19.html',
                    'Data/chat_2023_02_20.html',
                    'Data/chat_2023_02_21.html',
                    'Data/chat_2023_02_22.html',
                    'Data/chat_2023_02_23.html',
                    'Data/chat_2023_02_24.html',
                    'Data/chat_2023_02_25.html',
                    'Data/chat_2023_02_26.html',
                    'Data/chat_2023_02_27.html',
                    'Data/chat_2023_02_28.html',
                    'Data/chat_2023_03_01.html',
                    'Data/chat_2023_03_02.html',
                    'Data/chat_2023_03_03.html',
                    'Data/chat_2023_03_04.html',
                    'Data/chat_2023_03_05.html',
                    'Data/chat_2023_03_06.html',
                    'Data/chat_2023_03_07.html',
                    'Data/chat_2023_03_08.html',
                    'Data/chat_2023_03_09.html',
                    'Data/chat_2023_03_10.html',
                    'Data/chat_2023_03_11.html',
                    'Data/chat_2023_03_12.html',
                    'Data/chat_2023_03_13.html',
                    'Data/chat_2023_03_14.html',
                    'Data/chat_2023_03_15.html',
                    'Data/chat_2023_03_16.html',
                    'Data/chat_2023_03_17.html',
                    'Data/chat_2023_03_18.html',
                    'Data/chat_2023_03_19.html',
                    'Data/chat_2023_03_20.html',
                    'Data/chat_2023_03_21.html',
                    'Data/chat_2023_03_22.html',
                    'Data/chat_2023_03_23.html',
                    'Data/chat_2023_03_24.html',
                    'Data/chat_2023_03_25.html',
                    'Data/chat_2023_03_26.html',
                    'Data/chat_2023_03_27.html',
                    'Data/chat_2023_03_28.html',
                    'Data/chat_2023_03_29.html',
                    'Data/chat_2023_03_30.html',
                    'Data/chat_2023_03_31.html',
                    'Data/chat_2023_04_01.html',
                    'Data/chat_2023_04_02.html',
                    'Data/chat_2023_04_03.html',
                    'Data/chat_2023_04_04.html',
                    'Data/chat_2023_04_05.html',
                    'Data/chat_2023_04_06.html',
                    'Data/chat_2023_04_07.html',
                    'Data/chat_2023_04_08.html',
                    'Data/chat_2023_04_09.html',
                    'Data/chat_2023_04_10.html',
                    'Data/chat_2023_04_11.html',
                    'Data/chat_2023_04_12.html',
                    'Data/chat_2023_04_13.html',
                    'Data/chat_2023_04_14.html',
                    'Data/chat_2023_04_15.html',
                    'Data/chat_2023_04_16.html',
                    'Data/chat_2023_04_17.html',
                    'Data/chat_2023_04_18.html',
                    'Data/chat_2023_04_19.html',
                    'Data/chat_2023_04_20.html',
                    'Data/chat_2023_04_21.html',
                    'Data/chat_2023_04_22.html',
                    'Data/chat_2023_04_23.html',
                    'Data/chat_2023_04_24.html',
                    'Data/chat_2023_04_25.html',
                    'Data/chat_2023_04_26.html',
                    'Data/chat_2023_04_27.html',
                    'Data/chat_2023_04_28.html',
                    'Data/chat_2023_04_29.html',
                    'Data/chat_2023_04_30.html',
                    'Data/chat_2023_05_01.html',
                    'Data/chat_2023_05_02.html',
                    'Data/chat_2023_05_03.html',
                    'Data/chat_2023_05_04.html',
                    'Data/chat_2023_05_05.html',
                    'Data/chat_2023_05_06.html',
                    'Data/chat_2023_05_07.html',
                    'Data/chat_2023_05_08.html',
                    'Data/chat_2023_05_09.html',
                    'Data/chat_2023_05_10.html',
                    'Data/chat_2023_05_11.html',
                    'Data/chat_2023_05_12.html',
                    'Data/chat_2023_05_13.html',
                    'Data/chat_2023_05_14.html',
                    'Data/chat_2023_05_15.html',
                    'Data/chat_2023_05_16.html',
                    'Data/chat_2023_05_17.html',
                    'Data/chat_2023_05_18.html',
                    'Data/chat_2023_05_19.html',
                    'Data/chat_2023_05_20.html',
                    'Data/chat_2023_05_21.html',
                    'Data/chat_2023_05_22.html',
                    'Data/chat_2023_05_23.html',
                    'Data/chat_2023_05_24.html',
                    'Data/chat_2023_05_25.html',
                    'Data/chat_2023_05_26.html',
                    'Data/chat_2023_05_27.html',
                    'Data/chat_2023_05_28.html',
                    'Data/chat_2023_05_29.html',
                    'Data/chat_2023_05_30.html',
                    'Data/chat_2023_05_31.html',
                    'Data/chat_2023_06_01.html',
                    'Data/chat_2023_06_02.html',
                    'Data/chat_2023_06_03.html',
                    'Data/chat_2023_06_04.html',
                    'Data/chat_2023_06_05.html',
                    'Data/chat_2023_06_06.html',
                    'Data/chat_2023_06_07.html',
                    'Data/chat_2023_06_08.html',
                    'Data/chat_2023_06_09.html',
                    'Data/chat_2023_06_10.html',
                    'Data/chat_2023_06_11.html',
                    'Data/chat_2023_06_12.html',
                    'Data/chat_2023_06_13.html',
                    'Data/chat_2023_06_14.html',
                    'Data/chat_2023_06_15.html',
                    'Data/chat_2023_06_16.html',
                    'Data/chat_2023_06_17.html',
                    'Data/chat_2023_06_18.html',
                    'Data/chat_2023_06_19.html',
                    'Data/chat_2023_06_20.html',
                    'Data/chat_2023_06_21.html',
                    'Data/chat_2023_06_22.html',
                    'Data/chat_2023_06_23.html',
                    'Data/chat_2023_06_24.html',
                    'Data/chat_2023_06_25.html',
                    'Data/chat_2023_06_26.html',
                    'Data/chat_2023_06_27.html',
                    'Data/chat_2023_06_28.html',
                    'Data/chat_2023_06_29.html',
                    'Data/chat_2023_06_30.html',
                    'Data/chat_2023_07_01.html',
                    'Data/chat_2023_07_02.html',
                    'Data/chat_2023_07_03.html',
                    'Data/chat_2023_07_04.html',
                    'Data/chat_2023_07_05.html',
                    'Data/chat_2023_07_06.html',
                    'Data/chat_2023_07_07.html',
                    'Data/chat_2023_07_08.html',
                    'Data/chat_2023_07_09.html',
                    'Data/chat_2023_07_10.html',
                    'Data/chat_2023_07_11.html',
                    'Data/chat_2023_07_12.html',
                    'Data/chat_2023_07_13.html',
                    'Data/chat_2023_07_14.html',
                    'Data/chat_2023_07_15.html',
                    'Data/chat_2023_07_16.html',
                    'Data/chat_2023_07_17.html',
                    'Data/chat_2023_07_18.html',
                    'Data/chat_2023_07_19.html',
                    'Data/chat_2023_07_20.html',
                    'Data/chat_2023_07_21.html',
                    'Data/chat_2023_07_22.html',
                    'Data/chat_2023_07_23.html',
                    'Data/chat_2023_07_24.html',
                    'Data/chat_2023_07_25.html',
                    'Data/chat_2023_07_26.html',
                    'Data/chat_2023_07_27.html',
                    'Data/chat_2023_07_28.html',
                    'Data/chat_2023_07_29.html',
                    'Data/chat_2023_07_30.html',
                    'Data/chat_2023_07_31.html',
                    'Data/chat_2023_08_01.html',
                    'Data/chat_2023_08_02.html',
                    'Data/chat_2023_08_03.html',
                    'Data/chat_2023_08_04.html',
                    'Data/chat_2023_08_05.html',
                    'Data/chat_2023_08_06.html',
                    'Data/chat_2023_08_07.html',
                    'Data/chat_2023_08_08.html',
                    'Data/chat_2023_08_09.html',
                    'Data/chat_2023_08_10.html',
                    'Data/chat_2023_08_11.html',
                    'Data/chat_2023_08_12.html',
                    'Data/chat_2023_08_13.html',
                    'Data/chat_2023_08_14.html',
                    'Data/chat_2023_08_15.html',
                    'Data/chat_2023_08_16.html',
                    'Data/chat_2023_08_17.html',
                    'Data/chat_2023_08_18.html',
                    'Data/chat_2023_08_19.html',
                    'Data/chat_2023_08_20.html',
                    'Data/chat_2023_08_21.html',
                    'Data/chat_2023_08_22.html',
                    'Data/chat_2023_08_23.html',
                    'Data/chat_2023_08_24.html',
                    'Data/chat_2023_08_25.html',
                    'Data/chat_2023_08_26.html',
                    'Data/chat_2023_08_27.html',
                    'Data/chat_2023_08_28.html',
                    'Data/chat_2023_08_29.html',
                    'Data/chat_2023_08_30.html',
                    'Data/chat_2023_08_31.html',
                    'Data/chat_2023_09_01.html',
                    'Data/chat_2023_09_02.html',
                    'Data/chat_2023_09_03.html',
                    'Data/chat_2023_09_04.html',
                    'Data/chat_2023_09_05.html',
                    'Data/chat_2023_09_06.html',
                    'Data/chat_2023_09_07.html',
                    'Data/chat_2023_09_08.html',
                    'Data/chat_2023_09_09.html',
                    'Data/chat_2023_09_10.html',
                    'Data/chat_2023_09_11.html',
                    'Data/chat_2023_09_12.html',
                    'Data/chat_2023_09_13.html',
                    'Data/chat_2023_09_14.html',
                    'Data/chat_2023_09_15.html',
                    'Data/chat_2023_09_16.html',
                    'Data/chat_2023_09_17.html',
                    'Data/chat_2023_09_18.html',
                    'Data/chat_2023_09_19.html',
                    'Data/chat_2023_09_20.html',
                    'Data/chat_2023_09_21.html',
                    'Data/chat_2023_09_22.html',
                    'Data/chat_2023_09_23.html',
                    'Data/chat_2023_09_24.html',
                    'Data/chat_2023_09_25.html',
                    'Data/chat_2023_09_26.html',
                    'Data/chat_2023_09_27.html',
                    'Data/chat_2023_09_28.html',
                    'Data/chat_2023_09_29.html',
                    'Data/chat_2023_09_30.html',
                    'Data/chat_2023_10_01.html',
                    'Data/chat_2023_10_02.html',
                    'Data/chat_2023_10_03.html',
                    'Data/chat_2023_10_04.html',
                    'Data/chat_2023_10_05.html',
                    'Data/chat_2023_10_06.html',
                    'Data/chat_2023_10_07.html',
                    'Data/chat_2023_10_08.html',
                    'Data/chat_2023_10_09.html',
                    'Data/chat_2023_10_10.html',
                    'Data/chat_2023_10_11.html',
                    'Data/chat_2023_10_12.html',
                    'Data/chat_2023_10_13.html',
                    'Data/chat_2023_10_14.html',
                    'Data/chat_2023_10_15.html',
                    'Data/chat_2023_10_16.html',
                    'Data/chat_2023_10_17.html',
                    'Data/chat_2023_10_18.html',
                    'Data/chat_2023_10_19.html',
                    'Data/chat_2023_10_20.html',
                    'Data/chat_2023_10_21.html',
                    'Data/chat_2023_10_22.html',
                    'Data/chat_2023_10_23.html',
                    'Data/chat_2023_10_24.html',
                    'Data/chat_2023_10_25.html',
                    'Data/chat_2023_10_26.html',
                    'Data/chat_2023_10_27.html',
                    'Data/chat_2023_10_28.html',
                    'Data/chat_2023_10_29.html'
                ];
                
                this.searchHistory = [];
                this.hotKeywords = ['ä½ å¥½', 'è°¢è°¢', 'æ™šå®‰', 'å“ˆå“ˆ', 'å¼€å¿ƒ', 'å¿™ç¢Œ', 'å‘¨æœ«', 'ç”Ÿæ—¥'];
                this.isSearching = false;
                this.searchController = null;
                
                this.initializeEventListeners();
                this.loadSearchHistory();
            }

            initializeEventListeners() {
                const searchInput = document.getElementById('searchInput');
                const searchButton = document.getElementById('searchButton');
                const cancelButton = document.getElementById('cancelButton');
                const keywordTags = document.getElementById('keywordTags');

                // æœç´¢è¾“å…¥äº‹ä»¶
                searchInput.addEventListener('input', (e) => {
                    this.handleSearchInput(e.target.value);
                });

                // æœç´¢æŒ‰é’®ç‚¹å‡»
                searchButton.addEventListener('click', () => {
                    this.performSearch(searchInput.value);
                });

                // å–æ¶ˆæŒ‰é’®ç‚¹å‡»
                cancelButton.addEventListener('click', () => {
                    this.cancelSearch();
                });

                // å›è½¦æœç´¢
                searchInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.performSearch(searchInput.value);
                    }
                });

                // çƒ­é—¨å…³é”®è¯ç‚¹å‡»
                keywordTags.addEventListener('click', (e) => {
                    if (e.target.classList.contains('keyword-tag')) {
                        const keyword = e.target.getAttribute('data-keyword');
                        searchInput.value = keyword;
                        this.performSearch(keyword);
                    }
                });

                // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­å»ºè®®ä¸‹æ‹‰æ¡†
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('.search-input-wrapper')) {
                        this.hideSuggestions();
                    }
                });
            }

            handleSearchInput(query) {
                if (query.length === 0) {
                    this.hideSuggestions();
                    return;
                }

                if (query.length >= 2) {
                    this.showSuggestions(query);
                } else {
                    this.hideSuggestions();
                }
            }

            showSuggestions(query) {
                const suggestions = this.getSuggestions(query);
                const dropdown = document.getElementById('suggestionsDropdown');
                
                if (suggestions.length === 0) {
                    this.hideSuggestions();
                    return;
                }

                dropdown.innerHTML = suggestions.map(suggestion => `
                    <div class="suggestion-item" data-suggestion="${suggestion.text}">
                        ${this.highlightMatch(suggestion.text, query)}
                        <small style="color: #6c757d; margin-left: 8px;">${suggestion.count} æ¬¡å‡ºç°</small>
                    </div>
                `).join('');

                dropdown.style.display = 'block';

                // æ·»åŠ ç‚¹å‡»äº‹ä»¶
                dropdown.addEventListener('click', (e) => {
                    const item = e.target.closest('.suggestion-item');
                    if (item) {
                        const suggestion = item.getAttribute('data-suggestion');
                        document.getElementById('searchInput').value = suggestion;
                        this.performSearch(suggestion);
                        this.hideSuggestions();
                    }
                });
            }

            hideSuggestions() {
                document.getElementById('suggestionsDropdown').style.display = 'none';
            }

            getSuggestions(query) {
                const suggestions = [];
                const lowerQuery = query.toLowerCase();

                // ä»æœç´¢å†å²ä¸­è·å–å»ºè®®
                this.searchHistory.forEach(item => {
                    if (item.query.toLowerCase().includes(lowerQuery)) {
                        suggestions.push({
                            text: item.query,
                            count: item.resultCount
                        });
                    }
                });

                // ä»çƒ­é—¨å…³é”®è¯ä¸­è·å–å»ºè®®
                this.hotKeywords.forEach(keyword => {
                    if (keyword.toLowerCase().includes(lowerQuery)) {
                        suggestions.push({
                            text: keyword,
                            count: Math.floor(Math.random() * 50) + 10 // æ¨¡æ‹Ÿå‡ºç°æ¬¡æ•°
                        });
                    }
                });

                // å»é‡å¹¶é™åˆ¶æ•°é‡
                const uniqueSuggestions = suggestions.filter((item, index, self) => 
                    index === self.findIndex(t => t.text === item.text)
                );

                return uniqueSuggestions.slice(0, 5);
            }

            highlightMatch(text, query) {
                const regex = new RegExp(`(${query})`, 'gi');
                return text.replace(regex, '<span class="suggestion-highlight">$1</span>');
            }

            async performSearch(query) {
                if (!query.trim()) {
                    this.showMessage('è¯·è¾“å…¥æœç´¢å…³é”®è¯');
                    return;
                }

                if (this.isSearching) {
                    this.cancelSearch();
                }

                this.isSearching = true;
                this.showSearchProgress();
                this.updateSearchButton(true);

                const startTime = Date.now();
                const results = [];
                let searchedCount = 0;

                try {
                    this.searchController = new AbortController();
                    const signal = this.searchController.signal;

                    // åˆ†æ‰¹å¤„ç†æ–‡ä»¶ï¼Œé¿å…é˜»å¡UI
                    const batchSize = 10;
                    for (let i = 0; i < this.files.length; i += batchSize) {
                        if (signal.aborted) {
                            throw new Error('æœç´¢å·²å–æ¶ˆ');
                        }

                        const batch = this.files.slice(i, i + batchSize);
                        const batchResults = await this.searchBatch(batch, query, signal);
                        results.push(...batchResults);
                        searchedCount += batch.length;

                        // æ›´æ–°è¿›åº¦
                        this.updateProgress(searchedCount, this.files.length, results.length);
                        
                        // è®©UIæœ‰æœºä¼šæ›´æ–°
                        await new Promise(resolve => setTimeout(resolve, 10));
                    }

                    // æ˜¾ç¤ºç»“æœ
                    this.displayResults(results, query);
                    
                    // ä¿å­˜åˆ°æœç´¢å†å²
                    this.addToSearchHistory(query, results.length);

                } catch (error) {
                    if (error.message === 'æœç´¢å·²å–æ¶ˆ') {
                        this.showMessage('æœç´¢å·²å–æ¶ˆ');
                    } else {
                        this.showMessage('æœç´¢å‡ºé”™: ' + error.message);
                    }
                } finally {
                    this.isSearching = false;
                    this.hideSearchProgress();
                    this.updateSearchButton(false);
                    this.searchController = null;
                }
            }

            async searchBatch(files, query, signal) {
                const results = [];
                
                for (const file of files) {
                    if (signal.aborted) break;
                    
                    try {
                        const response = await fetch(file, { signal });
                        if (!response.ok) continue;
                        
                        const html = await response.text();
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(html, 'text/html');
                        
                        const messages = doc.querySelectorAll('.message');
                        messages.forEach(message => {
                            if (signal.aborted) return;
                            
                            const content = message.textContent || '';
                            if (content.toLowerCase().includes(query.toLowerCase())) {
                                const sender = message.querySelector('.sender')?.textContent || 'æœªçŸ¥';
                                const time = message.querySelector('.time')?.textContent || '';
                                const messageId = message.getAttribute('id') || '';
                                
                                results.push({
                                    content: this.extractContent(message),
                                    sender: sender,
                                    time: time,
                                    file: file,
                                    messageId: messageId,
                                    relevance: this.calculateRelevance(content, query)
                                });
                            }
                        });
                    } catch (error) {
                        console.warn(`æœç´¢æ–‡ä»¶ ${file} æ—¶å‡ºé”™:`, error);
                    }
                }
                
                return results;
            }

            extractContent(message) {
                const contentElement = message.querySelector('.content');
                if (!contentElement) return '';
                
                // å…‹éš†å…ƒç´ ä»¥é¿å…ä¿®æ”¹åŸå§‹DOM
                const clone = contentElement.cloneNode(true);
                
                // ç§»é™¤è„šæœ¬å’Œæ ·å¼
                const scripts = clone.querySelectorAll('script, style');
                scripts.forEach(el => el.remove());
                
                return clone.textContent || clone.innerText || '';
            }

            calculateRelevance(content, query) {
                const lowerContent = content.toLowerCase();
                const lowerQuery = query.toLowerCase();
                
                let score = 0;
                
                // å®Œå…¨åŒ¹é…å¾—åˆ†æœ€é«˜
                if (lowerContent === lowerQuery) score += 100;
                
                // åŒ…å«å®Œæ•´æŸ¥è¯¢
                if (lowerContent.includes(lowerQuery)) score += 50;
                
                // æŸ¥è¯¢è¯å‡ºç°æ¬¡æ•°
                const matches = lowerContent.match(new RegExp(lowerQuery, 'g'));
                if (matches) score += matches.length * 10;
                
                // å†…å®¹é•¿åº¦é€‚ä¸­çš„å¾—åˆ†æ›´é«˜
                const contentLength = content.length;
                if (contentLength > 10 && contentLength < 200) score += 5;
                
                return score;
            }

            cancelSearch() {
                if (this.searchController) {
                    this.searchController.abort();
                }
            }

            showSearchProgress() {
                document.getElementById('progressSection').style.display = 'block';
                document.getElementById('resultsSection').innerHTML = `
                    <div class="no-results">
                        <div class="loading-spinner"></div>
                        <h3>æ­£åœ¨æœç´¢...</h3>
                        <p>è¯·ç¨å€™ï¼Œæ­£åœ¨æœç´¢èŠå¤©è®°å½•</p>
                    </div>
                `;
            }

            hideSearchProgress() {
                document.getElementById('progressSection').style.display = 'none';
            }

            updateProgress(searched, total, found) {
                const percentage = Math.round((searched / total) * 100);
                document.getElementById('progressBar').style.width = percentage + '%';
                document.getElementById('searchedCount').textContent = searched;
                document.getElementById('foundCount').textContent = found;
                document.getElementById('progressText').textContent = `æ­£åœ¨æœç´¢ ${searched}/${total} ä¸ªæ–‡ä»¶...`;
            }

            updateSearchButton(isSearching) {
                const searchButton = document.getElementById('searchButton');
                const cancelButton = document.getElementById('cancelButton');
                
                if (isSearching) {
                    searchButton.style.display = 'none';
                    cancelButton.style.display = 'block';
                } else {
                    searchButton.style.display = 'block';
                    cancelButton.style.display = 'none';
                }
            }

            displayResults(results, query) {
                const resultsSection = document.getElementById('resultsSection');
                const searchStats = document.getElementById('searchStats');
                
                if (results.length === 0) {
                    resultsSection.innerHTML = `
                        <div class="no-results">
                            <div class="no-results-icon">ğŸ˜”</div>
                            <h3>æœªæ‰¾åˆ°ç›¸å…³ç»“æœ</h3>
                            <p>å°è¯•ä½¿ç”¨å…¶ä»–å…³é”®è¯æˆ–æ£€æŸ¥æ‹¼å†™</p>
                        </div>
                    `;
                    searchStats.style.display = 'none';
                    return;
                }

                // æŒ‰ç›¸å…³æ€§æ’åº
                results.sort((a, b) => b.relevance - a.relevance);

                // æ˜¾ç¤ºç»“æœ
                resultsSection.innerHTML = results.map(result => `
                    <div class="result-item" onclick="window.open('${result.file}#${result.messageId}', '_blank')">
                        <div class="result-header">
                            <span class="result-sender">${result.sender}</span>
                            <span class="result-time">${result.time}</span>
                        </div>
                        <div class="result-content">${this.highlightSearchTerm(result.content, query)}</div>
                        <div class="result-file">ğŸ“ ${result.file}</div>
                    </div>
                `).join('');

                // æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
                searchStats.style.display = 'block';
                document.getElementById('statsText').textContent = `æ‰¾åˆ° ${results.length} æ¡ç›¸å…³ç»“æœï¼Œæœç´¢ç”¨æ—¶ ${Date.now() - this.getSearchStartTime()}ms`;
            }

            highlightSearchTerm(text, query) {
                if (!query) return text;
                
                const regex = new RegExp(`(${query})`, 'gi');
                return text.replace(regex, '<span class="highlight">$1</span>');
            }

            getSearchStartTime() {
                // è¿™é‡Œåº”è¯¥å­˜å‚¨å¼€å§‹æ—¶é—´ï¼Œç®€åŒ–å¤„ç†
                return 0;
            }

            showMessage(message) {
                const resultsSection = document.getElementById('resultsSection');
                resultsSection.innerHTML = `
                    <div class="no-results">
                        <div class="no-results-icon">âš ï¸</div>
                        <h3>${message}</h3>
                    </div>
                `;
            }

            addToSearchHistory(query, resultCount) {
                // é¿å…é‡å¤
                const existingIndex = this.searchHistory.findIndex(item => item.query === query);
                if (existingIndex !== -1) {
                    this.searchHistory.splice(existingIndex, 1);
                }
                
                this.searchHistory.unshift({
                    query: query,
                    resultCount: resultCount,
                    timestamp: Date.now()
                });
                
                // é™åˆ¶å†å²è®°å½•æ•°é‡
                if (this.searchHistory.length > 20) {
                    this.searchHistory = this.searchHistory.slice(0, 20);
                }
                
                this.saveSearchHistory();
            }

            saveSearchHistory() {
                try {
                    localStorage.setItem('chatSearchHistory', JSON.stringify(this.searchHistory));
                } catch (error) {
                    console.warn('ä¿å­˜æœç´¢å†å²å¤±è´¥:', error);
                }
            }

            loadSearchHistory() {
                try {
                    const saved = localStorage.getItem('chatSearchHistory');
                    if (saved) {
                        this.searchHistory = JSON.parse(saved);
                    }
                } catch (error) {
                    console.warn('åŠ è½½æœç´¢å†å²å¤±è´¥:', error);
                }
            }
        }

        // åˆå§‹åŒ–æœç´¢å¼•æ“
        const searchEngine = new ChatSearchEngine();
    </script>
</body>
</html>